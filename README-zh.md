一个实现 Obsidian 文档与觅思文档之间同步的插件。

- 为 Obsidian 用户提供了一个本地文档远程同步的新方案；
- 为 Obsidian 本地文档提供了一个 Web 在线浏览文档的新方案；
- 为觅思文档用户提供了一个离线编写、保存和同步文档的新方案；

## 系统要求

- 觅思文档专业版`v1.3.6+`、觅思文档开源版`v0.9.2+`
- Obsidian`v1.4.16+`

## 基本概念的对应关系

- Obsidian 的「仓库（Vault）」，对应于觅思文档的「文集」；
- Obsidian 仓库内的「Markdown 文件」，对应于觅思文档中的「文档」；
- Obsidian 仓库内的「文件夹」对应于觅思文档中包含下级文档的「文档」；

## 插件规则

### 仓库（Vault）

Obsidian 需要在插件的设置页面选择对应觅思文档的目标文集。
> 如果希望文档同步到一个新的觅思文档文集，可点击「新建」按钮新建一个文集后选择。

### 拉取远程文档

插件在左侧工具栏上添加了一个功能图标按钮，用于从觅思文档上拉取文集内所有文档到 Obsidian 本地。点击拉取操作后，插件会获取已指定文集内所有文档的信息并准备写入到 Obsidian 本地。

- 如果本地不存在同名的文件/文件夹，则新建文件/文件夹；
- 如果本地已存在同名的文件，判断本地文件是否与远程文档存在映射关系：
	- 如果存在映射关系，比对本地文件和远程文档的最后修改时间：
		- 如果本地文件最后修改时间新于远程文档，跳过；
		- 如果本地文件最后修改时间旧于远程文档，将远程文档的内容覆盖写入本地文件。
	- 如果不存在映射关系，跳过。
- 如果本地已存在同名文件夹，跳过。

### 新建文件/文件夹

Obsidian 本地新建文件/文件夹，会自动在觅思文档指定的文集中创建一个文档，并在插件内维护一个本地文档与远程文档的映射关系；

### 重命名文件/文件夹

在 Obsidian 本地对文件/文件夹进行重命名，会自动修改觅思文档上对应的文档标题。

### 修改文件

修改文件内容后，你可以在编辑器右上角的「更多选项」中点击「同步至 MrDoc」菜单将文档的更新推送到觅思文档。

你也可以在 Obsidian 软件的左侧文件列表中，鼠标停留在指定的文档上，点击鼠标右键，唤出上下文菜单后，点击「同步至 MrDoc」菜单将文档的更新推送到觅思文档。

除此之外，插件提供了一个**实时推送**的选项，你可以在插件的设置页面开启「实时更新文档内容」，这样，当你在 Obsidian 中修改了文件内容，插件会实时将最新的文件内容更新到觅思文档上。

### 删除文件/文件夹

如果 Obsidian 本地的文件/文件夹与觅思文档建立了映射关系，那么在本地删除文件/文件夹，插件也会同步将觅思文档内的文档进行删除（软删除，文档进入回收站）。

### 图片处理

对于图片的处理，插件提供了两个选项：

- 转存本地图片
- 转存粘贴板中的图片

**1、转存本地图片**

当你粘贴或拖拽本地图片到 Obsidian 编辑器内时，插件会将图片上传至觅思文档，然后返回觅思文档的图片链接地址并填入 Obsidian 编辑器。

**2、转存粘贴板中的图片**

当你在别处复制了文本要粘贴到 Obsidian 编辑器内时，插件会提取其中的图片链接，并将其上传至觅思文档，然后返回觅思文档的图片链接地址替换掉原文本中的图片链接。

### 重置映射关系

在 Obsidian 本地文件于觅思文档的文档建立了映射关系后，如果你需要接触其绑定的映射关系，可以在插件的设置页面点击「重置文档映射」，这样，对 Obsidian 本地文件的操作将不会同步至觅思文档。
